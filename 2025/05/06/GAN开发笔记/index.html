<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1"><meta name="viewport" content="width=device-width, initial-scale=1"><meta name="keywords"><meta name="descriptioon" content=""><meta name="renderer" content="wekit"><link rel="shortcut icon" href="/images/favicon.ico" type="image/x-icon"><link rel="stylesheet" href="/css/public.css"><link rel="stylesheet" href="/css/reset.css"><link rel="stylesheet" href="/css/iconfont.css"><title>围绕GAN的一个小开发 [ Hexo ]</title><link rel="stylesheet" href="/css/partial/footer.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.css"><link rel="stylesheet" href="/css/partial/sidebar.css"><link rel="stylesheet" href="/css/post.css"><link rel="stylesheet" href="https://imsun.github.io/gitment/style/default.css"><meta name="generator" content="Hexo 8.1.1"></head><body><link rel="stylesheet" href="/css/partial/header.css"><div class="header"><div class="maxwidth"><div class="nav"><a id="artlist" href="/404"><i class="iconfont icon404"></i><span class="headhid">&nbsp;404</span></a><a id="artlist" href="/archives"><i class="iconfont iconarchives"></i><span class="headhid">&nbsp;Archives</span></a><a id="artlist" href="/link"><i class="iconfont iconlink"></i><span class="headhid">&nbsp;Link</span></a><a id="artlist" href="/about"><i class="iconfont iconabout"></i><span class="headhid">&nbsp;About</span></a></div><a class="search" href="/">Woore</a></div></div><div class="main"> <div class="maxwidth"><link rel="stylesheet" href="/css/partial/sidebar.css"><div id="sidebar"><div class="social"><a href="/archives" title="Home"><i class="iconfont iconHome"></i></a><a href="mailto:tongt0232@gmail.com" title="E-Mail"><i class="iconfont iconweibiaoti554"></i></a><a target="_blank" rel="noopener" href="https://github.com/Woor3x" title="GitHub"><i class="iconfont iconGitHub"></i></a><a target="_blank" rel="noopener" href="https://juejin.cn/user/1204720474809741" title="juejin"><img src="/images/juejinicon-sidebar.png"></a><a target="_blank" rel="noopener" href="https://www.jianshu.com/u/20de04cc53de" title="jianshu"><img src="/images/jianicon-sidebar.png"></a></div><div class="structure category-list"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%9B%B4%E7%BB%95GAN%E7%9A%84%E4%B8%80%E4%B8%AA%E5%B0%8F%E5%BC%80%E5%8F%91"><span class="toc-number">1.</span> <span class="toc-text">围绕GAN的一个小开发</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AE%80%E4%BB%8B"><span class="toc-number">1.1.</span> <span class="toc-text">简介</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99"><span class="toc-number">1.2.</span> <span class="toc-text">参考资料</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#GAN-%E5%9F%BA%E6%9C%AC%E5%8E%9F%E7%90%86"><span class="toc-number">1.3.</span> <span class="toc-text">GAN 基本原理</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8D%B7%E7%A7%AF%E6%A0%B8%E5%B8%B8%E7%94%A8%E5%8F%82%E6%95%B0"><span class="toc-number">1.4.</span> <span class="toc-text">卷积核常用参数</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%98%B2%E6%AD%A2%E8%AE%AD%E7%BB%83%E5%B4%A9%E6%BA%83%E7%9A%84%E6%8A%80%E5%B7%A7"><span class="toc-number">1.5.</span> <span class="toc-text">防止训练崩溃的技巧</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E9%99%8D%E4%BD%8E%E5%88%A4%E5%88%AB%E5%99%A8%E5%AD%A6%E4%B9%A0%E7%8E%87"><span class="toc-number">1.5.1.</span> <span class="toc-text">(1) 降低判别器学习率</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E8%AE%A9-G-%E8%AE%AD%E7%BB%83%E6%9B%B4%E5%A4%9A%E6%AC%A1"><span class="toc-number">1.5.2.</span> <span class="toc-text">(2) 让 G 训练更多次</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-%E4%BD%BF%E7%94%A8-Label-Smoothing%EF%BC%88%E6%A0%87%E7%AD%BE%E5%B9%B3%E6%BB%91%EF%BC%89"><span class="toc-number">1.5.3.</span> <span class="toc-text">(3) 使用 Label Smoothing（标签平滑）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-%E6%B7%BB%E5%8A%A0%E5%99%AA%E5%A3%B0"><span class="toc-number">1.5.4.</span> <span class="toc-text">(4) 添加噪声</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-%E4%BD%BF%E7%94%A8-WGAN-GP"><span class="toc-number">1.5.5.</span> <span class="toc-text">(5) 使用 WGAN-GP</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%A1%B9%E7%9B%AE%E4%BB%93%E5%BA%93"><span class="toc-number">1.6.</span> <span class="toc-text">项目仓库</span></a></li></ol></li></ol></div><div class="tags"><a href="/tags/AI/" style="font-size: 24px; color: #b46e00">AI</a> <a href="/tags/CTF/" style="font-size: 24px; color: #b46e00">CTF</a> <a href="/tags/Note/" style="font-size: 12px; color: #ffac00">Note</a> <a href="/tags/web/" style="font-size: 12px; color: #ffac00">web</a> <a href="/tags/%E5%A6%99%E5%A6%99%E5%B0%8F%E5%B7%A5%E5%85%B7/" style="font-size: 12px; color: #ffac00">妙妙小工具</a> <a href="/tags/%E6%A0%87%E7%AD%BE/" style="font-size: 12px; color: #ffac00">标签</a></div></div><div class="post rightside"><h1 class="artititle">围绕GAN的一个小开发</h1><div class="info"><i class="iconfont iconbiaoqian" title="文章标签"><span>AI</span></i><i class="iconfont iconshijian"><span title="文章发布时间">2025-05-06</span></i></div><div class="postDetail"><h1 id="围绕GAN的一个小开发"><a href="#围绕GAN的一个小开发" class="headerlink" title="围绕GAN的一个小开发"></a>围绕GAN的一个小开发</h1><hr>
<h2 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h2><p>高二的时候社团设计本来打算从底层搓一个 GAN，但后来训练太慢了就放弃了。现在重新用 <strong>PyTorch</strong> 实现，还结合了之前想用 <strong>Flet</strong> 写的一个项目，也算是填上了当年的坑。</p>
<hr>
<h2 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h2><ul>
<li><a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_43334693/article/details/135271954">适合小白学习的 GAN（生成对抗网络）算法超详细解读 - CSDN</a></li>
<li><a target="_blank" rel="noopener" href="https://www.bilibili.com/video/BV1Sg41197kL/?spm_id_from=333.337.search-card.all.click&vd_source=c4c6ab9b01e1af461ad9ee700205a165">【论文必读#2: ADAM算法】史上最火梯度下降算法是如何炼成的？ - 哔哩哔哩</a></li>
</ul>
<hr>
<h2 id="GAN-基本原理"><a href="#GAN-基本原理" class="headerlink" title="GAN 基本原理"></a>GAN 基本原理</h2><p>GAN（Generative Adversarial Network，生成对抗网络）由两个网络组成：</p>
<ul>
<li><strong>生成器（Generator）</strong>：生成假数据，试图以假乱真；</li>
<li><strong>判别器（Discriminator）</strong>：判断输入是真数据还是假数据。</li>
</ul>
<p>两者不断对抗与优化，直至生成数据足够逼真。</p>
<hr>
<h2 id="卷积核常用参数"><a href="#卷积核常用参数" class="headerlink" title="卷积核常用参数"></a>卷积核常用参数</h2><table>
<thead>
<tr>
<th>参数 (kernel_size, stride, padding)</th>
<th>作用说明</th>
</tr>
</thead>
<tbody><tr>
<td>(3,1,1)</td>
<td>保持输入尺寸不变（常见）</td>
</tr>
<tr>
<td>(3,2,1)</td>
<td>尺寸缩小 2×（常见）</td>
</tr>
<tr>
<td>(4,2,1)</td>
<td>尺寸缩小 2×，但影响范围稍大</td>
</tr>
<tr>
<td>(5,1,2)</td>
<td>尺寸不变，但感受野更大</td>
</tr>
<tr>
<td>(5,2,2)</td>
<td>尺寸缩小 2×，感受野更大</td>
</tr>
</tbody></table>
<blockquote>
<p>项目中采用 <code>(4,2,1)</code> 的卷积核，方便根据输入图片大小动态调整卷积层数。</p>
</blockquote>
<hr>
<h2 id="防止训练崩溃的技巧"><a href="#防止训练崩溃的技巧" class="headerlink" title="防止训练崩溃的技巧"></a>防止训练崩溃的技巧</h2><h3 id="1-降低判别器学习率"><a href="#1-降低判别器学习率" class="headerlink" title="(1) 降低判别器学习率"></a>(1) 降低判别器学习率</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">optimizer_G = torch.optim.Adam(generator.parameters(), lr=<span class="number">0.0002</span>, betas=(<span class="number">0.5</span>, <span class="number">0.999</span>))</span><br><span class="line">optimizer_D = torch.optim.Adam(discriminator.parameters(), lr=<span class="number">0.0001</span>, betas=(<span class="number">0.5</span>, <span class="number">0.999</span>))</span><br></pre></td></tr></table></figure>

<hr>
<h3 id="2-让-G-训练更多次"><a href="#2-让-G-训练更多次" class="headerlink" title="(2) 让 G 训练更多次"></a>(2) 让 G 训练更多次</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>): </span><br><span class="line">    train_generator()  <span class="comment"># 让 G 训练两次</span></span><br><span class="line">train_discriminator()</span><br></pre></td></tr></table></figure>

<hr>
<h3 id="3-使用-Label-Smoothing（标签平滑）"><a href="#3-使用-Label-Smoothing（标签平滑）" class="headerlink" title="(3) 使用 Label Smoothing（标签平滑）"></a>(3) 使用 Label Smoothing（标签平滑）</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">real_labels = torch.full((batch_size,), <span class="number">0.9</span>)</span><br><span class="line">fake_labels = torch.full((batch_size,), <span class="number">0.0</span>)</span><br></pre></td></tr></table></figure>

<hr>
<h3 id="4-添加噪声"><a href="#4-添加噪声" class="headerlink" title="(4) 添加噪声"></a>(4) 添加噪声</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">real_data += <span class="number">0.05</span> * torch.randn_like(real_data)</span><br></pre></td></tr></table></figure>

<hr>
<h3 id="5-使用-WGAN-GP"><a href="#5-使用-WGAN-GP" class="headerlink" title="(5) 使用 WGAN-GP"></a>(5) 使用 WGAN-GP</h3><p>使用 <strong>Wasserstein GAN（WGAN）</strong> 或 <strong>WGAN-GP</strong> 可减少梯度消失问题：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">loss = -torch.mean(D(real)) + torch.mean(D(fake))  <span class="comment"># WGAN 损失</span></span><br></pre></td></tr></table></figure>

<hr>
<h2 id="项目仓库"><a href="#项目仓库" class="headerlink" title="项目仓库"></a>项目仓库</h2><p>📦 GitHub Repo: <a target="_blank" rel="noopener" href="https://github.com/Woor3x/GANForge">Woor3x&#x2F;GANForge</a></p>
</div><link rel="stylesheet" href="/css/partial/footer.css"><div class="footer"><p><span>Copyright © 2017 - 2023</span><a target="_blank" rel="noopener" href="http://www.beian.miit.gov.cn/">蜀ICP备19024124号</a></p><p><i class="iconfont iconchakan"><span>本站总访问量</span><span id="busuanzi_container_site_pv">  <span id="busuanzi_value_site_pv"></span> </span></i><i class="iconfont iconabout"><span>本站访客数</span><span id="busuanzi_container_site_uv">  <span id="busuanzi_value_site_uv"></span> </span></i></p></div></div></div></div><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></body></html>